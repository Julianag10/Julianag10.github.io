<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Vive Wellness - Resources</title>
  <style>
    body { margin:0; font-family:sans-serif; }
    .main-nav {
      display:flex; justify-content:space-between;
      padding:.75rem 1rem; background:#befd73; color:black;
    }
    .nav-menu { display:flex; gap:1rem; list-style:none; margin:0; padding:0; }
    .nav-menu a { text-decoration:none; color:black; padding:.5rem; }
    .nav-menu a:hover, .nav-menu a:focus { background:rgba(0,0,0,0.1); border-radius:4px; }

    /* Grid container for resources */
    .gallery-container {
      display:grid;
      grid-template-areas:
        "header header"
        "tools  sidebar"
        "main   sidebar";
      grid-template-columns:2fr 1fr;
      grid-template-rows:auto auto 1fr;
      gap:1rem; padding:1rem;
    }
    .gallery-header { grid-area:header; }
    .tools { grid-area:tools; }
    .gallery-grid { grid-area:main; display:grid; grid-template-columns:repeat(auto-fit, minmax(250px,1fr)); gap:var(--card-gap,1rem); }
    .gallery-sidebar { grid-area:sidebar; background:#f0f0f0; padding:1rem; }

    .photo-card {
      border:2px solid black; background:lightblue; height:200px;
      display:flex; align-items:center; justify-content:center;
      transition:opacity .25s ease, transform .25s ease;
    }
    .photo-card.is-hidden { opacity:0; transform:scale(.98); pointer-events:none; }

    /* Compact density */
    :root { --card-gap:1rem; }
    body.compact { --card-gap:.5rem; }
    body.compact .photo-card { padding:.5rem; }

    /* Filter/search tools */
    .filter-btn[aria-pressed="true"] { outline:2px solid #333; border-radius:4px; }
    .tools { display:flex; flex-direction:column; gap:.5rem; }
    .result-count { font-style:italic; }

    /* Responsive collapse */
    @media(max-width:768px){
      .gallery-container {
        grid-template-areas:
          "header"
          "tools"
          "main"
          "sidebar";
        grid-template-columns:1fr;
      }
    }

    /* Visually hidden helper */
    .sr-only {
      position:absolute !important; width:1px; height:1px; padding:0; margin:-1px;
      overflow:hidden; clip:rect(0 0 0 0); white-space:nowrap; border:0;
    }
  </style>
</head>
<body>
  <nav class="main-nav">
    <div class="nav-brand">Vive Wellness</div>
    <ul class="nav-menu">
      <li><a href="index.html">Home</a></li>
      <li><a href="resources.html">Resources</a></li>
    </ul>
  </nav>

  <div class="gallery-container">
    <header class="gallery-header"><h1>Community Resources</h1></header>

    <section class="tools" aria-label="Resource tools">
      <div role="group" aria-label="Filter by category">
        <button class="filter-btn" data-filter="all" aria-pressed="true">All</button>
        <button class="filter-btn" data-filter="nature" aria-pressed="false">Nature</button>
        <button class="filter-btn" data-filter="architecture" aria-pressed="false">Architecture</button>
      </div>

      <label for="resource-search">Search resources</label>
      <input id="resource-search" type="search" placeholder="Type to filterâ€¦"/>

      <label><input id="density" type="checkbox"/> Compact view</label>

      <div id="results-announcer" aria-live="polite" class="sr-only"></div>
      <p class="result-count" aria-hidden="true"></p>
    </section>

    <main class="gallery-grid">
      <div class="photo-card" data-category="nature">Resource 1</div>
      <div class="photo-card" data-category="nature">Resource 2</div>
      <div class="photo-card" data-category="nature">Resource 3</div>
      <div class="photo-card" data-category="architecture">Resource 4</div>
      <div class="photo-card" data-category="architecture">Resource 5</div>
      <div class="photo-card" data-category="architecture">Resource 6</div>
    </main>

    <aside class="gallery-sidebar">Filter Options & Support</aside>
  </div>

  <script>
    const filterButtons = document.querySelectorAll('.filter-btn');
    const searchInput   = document.getElementById('resource-search');
    const densityToggle = document.getElementById('density');
    const cards         = document.querySelectorAll('.photo-card');
    const countEl       = document.querySelector('.result-count');
    const liveRegion    = document.getElementById('results-announcer');

    let currentFilter = 'all';
    let currentQuery  = '';

    function normalize(str){ return (str||'').toLowerCase().trim(); }
    function cardMatches(card, filter, query){
      const category = card.dataset.category || '';
      const text = card.textContent || '';
      return (filter==='all'||category===filter) && normalize(text).includes(normalize(query));
    }
    function updateCountAndAnnounce(visible){
      countEl.textContent = `Showing ${visible} resource${visible===1?'':'s'}.`;
      liveRegion.textContent = countEl.textContent;
    }
    function applyFilters(){
      let visible=0;
      cards.forEach(card=>{
        if(cardMatches(card,currentFilter,currentQuery)){
          card.classList.remove('is-hidden'); visible++;
        } else {
          card.classList.add('is-hidden');
        }
      });
      updateCountAndAnnounce(visible);
    }

    // Feature 1: Filter (click)
    filterButtons.forEach(btn=>{
      btn.addEventListener('click', e=>{
        currentFilter = btn.dataset.filter;
        filterButtons.forEach(b=>b.setAttribute('aria-pressed', String(b===btn)));
        applyFilters();
      });
    });

    // Feature 2: Search (input)
    searchInput.addEventListener('input', e=>{
      currentQuery = e.target.value;
      applyFilters();
    });

    // Feature 3: Density toggle (change + localStorage)
    function applyDensity(isCompact){
      document.body.classList.toggle('compact', isCompact);
      densityToggle.checked = isCompact;
      try{ localStorage.setItem('vw_density_compact', String(isCompact)); }catch{}
    }
    densityToggle.addEventListener('change', e=> applyDensity(e.target.checked));

    document.addEventListener('DOMContentLoaded', ()=>{
      let saved=null;
      try{ saved=localStorage.getItem('vw_density_compact'); }catch{}
      applyDensity(saved==='true');
      applyFilters();
    });
  </script>
</body>
</html>
